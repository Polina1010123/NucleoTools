# NucleoTools

NucleoTools - это набор инструментов для фильтрации секвенированных ридов ДНК. Он также предоставляет функционал для преобразования ДНК и РНК последовательностей.
## Содержание
- [Описание](#описание)
- [Установка](#установка)
- [Использование](#использование)


## Описание

### 1. Фильтрация 
Функция `filter_fastq` позволяет фильтровать последовательности ДНК на основе нескольких параметров: 
- среднее качества рида (`quality_threshold`)
- GC-состав рида (`gc_bounds`)
- длина рида (`length_bounds`)

### 2. Преобразование ДНК и РНК
Функция `run_dna_rna_tools` позволяет выполнять следующие действия с последовательностями ДНК и РНК:
- превращение кодирующей цепи ДНК в мРНК (`transcribe`)
- записывание последовательности в обратном порядке (`reverse`)
- создание комплементарной последовательности (`complement`)
- записывание комплеменентарной последовательности в обратном порядке (`reverse_complement`)

## Установка

1. Клонируйте репозиторий:
    ```bash
    git clone git@github.com:Polina1010123/dna-rna-tools-and-fastq-filtrator.git
    ```

2. Перейдите в директорию проекта:
    ```bash
    cd путь-к-директории-проекта
    ```

3. Настройте в fastq_filtrator.py корректный путь к директории modules для успешного выполнения импортов.

## Использование

1. **Фильтрация**
   
   В fastq_filtrator.pу в словарь seqs вставьте имя последовательности (ключ словаря), собственно нуклеотидную последовательность, а также качество прочтения ридов по шкале ASCII (значения словаря).
    
    ```python
    seqs = {
        "@SRX079801": ("AAAAAA", "@@@@@@@"),
        "@SRX079802": ("GCGCGC", "FGGGFG"),
        "@SRX079803": ("TTTTTTT", "0000000"),
    }
    ```
    В этом же файле укажите параметры для фильтрации: quality_threshold, gc_bounds, length_bounds.
    Обратите внимание, что в параметре quality_threshold можно указать только одно число, а в gc_bounds, length_bounds можно указывать как диапазон значений, так и одно число.
    Во втором случае будут удаляться те риды, у которых GC-состав/длины ридов больше указанного числа.
   
    ```python
    def filter_fastq(
        seqs, quality_threshold=40, gc_bounds=(20, 70), length_bounds=80
    ):
        filtered_seqs_gc_len = dop.filter_fastq(
            seqs, quality_threshold, gc_bounds, length_bounds
        )
    ```
    В примере выше будут сохранены такие риды, у которых среднее значение качество прочтения выше 40, GC-состав от 20 до 80 %, а длина меньше 80 п.н.

2. **Преобразование ДНК и РНК**

    В fastq_filtrator.pу в функции run_dna_rna_tools укажите последовательность для преобразования и тип преобразования.
   
    Примеры:
    ```python
    # превращение кодирующей цепи ДНК в мРНК
    result = run_dna_rna_tools("ATG", "transcribe")
    print(result)
    ```
    ```python
    # записывание последовательности в обратном порядке
    result = run_dna_rna_tools("ATG", "reverse")
    print(result)
    ```


